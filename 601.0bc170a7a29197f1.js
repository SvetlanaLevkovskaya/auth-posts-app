"use strict";(self.webpackChunkauth_post_app=self.webpackChunkauth_post_app||[]).push([[601],{7601:(Y,_,d)=>{d.r(_),d.d(_,{AuthModule:()=>K});var f=d(6814);function v(o,n,a,e,t,s,r){try{var l=o[s](r),c=l.value}catch(p){return void a(p)}l.done?n(c):Promise.resolve(c).then(e,t)}function O(o){return function(){var n=this,a=arguments;return new Promise(function(e,t){var s=o.apply(n,a);function r(c){v(s,e,t,r,l,"next",c)}function l(c){v(s,e,t,r,l,"throw",c)}r(void 0)})}}var i=d(4946),R=d(5619),I=d(8645);const P={now:()=>(P.delegate||Date).now(),delegate:void 0};class L extends I.x{constructor(n=1/0,a=1/0,e=P){super(),this._bufferSize=n,this._windowTime=a,this._timestampProvider=e,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=a===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,a)}next(n){const{isStopped:a,_buffer:e,_infiniteTimeWindow:t,_timestampProvider:s,_windowTime:r}=this;a||(e.push(n),!t&&e.push(s.now()+r)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const a=this._innerSubscribe(n),{_infiniteTimeWindow:e,_buffer:t}=this,s=t.slice();for(let r=0;r<s.length&&!n.closed;r+=e?1:2)n.next(s[r]);return this._checkFinalizedStatuses(n),a}_trimBuffer(){const{_bufferSize:n,_timestampProvider:a,_buffer:e,_infiniteTimeWindow:t}=this,s=(t?1:2)*n;if(n<1/0&&s<e.length&&e.splice(0,e.length-s),!t){const r=a.now();let l=0;for(let c=1;c<e.length&&e[c]<=r;c+=2)l=c;l&&e.splice(0,l+1)}}}class U extends I.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(n){const{hasError:a,_hasValue:e,_value:t,thrownError:s,isStopped:r,_isComplete:l}=this;a?n.error(s):(r||l)&&(e&&n.next(t),n.complete())}next(n){this.isStopped||(this._value=n,this._hasValue=!0)}complete(){const{_hasValue:n,_value:a,_isComplete:e}=this;e||(this._isComplete=!0,n&&super.next(a),super.complete())}}var E=d(2664),b=d(2181);function w(o){return(0,b.h)((n,a)=>o<=a)}var y=d(8180);class S{constructor(){}loadScript(n,a,e,t=null){if(typeof document<"u"&&!document.getElementById(n)){let s=document.createElement("script");s.async=!0,s.src=a,s.onload=e,t||(t=document.head),t.appendChild(s)}}}class T{}const D={oneTapEnabled:!0};let h=(()=>{class n extends S{constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new i.vpe,this._socialUser=new R.X(null),this._accessToken=new R.X(null),this._receivedAccessToken=new i.vpe,this.initOptions={...D,...this.initOptions},this._socialUser.pipe(w(1)).subscribe(this.changeUser),this._accessToken.pipe(w(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,s)=>{try{this.loadScript(n.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:r})=>{const l=this.createSocialUser(r);this._socialUser.next(l)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,b.h)(r=>null===r)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const r=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(l=>l).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:r,prompt:this.initOptions.prompt,callback:l=>{l.error?this._accessToken.error({code:l.error,description:l.error_description,uri:l.error_uri}):this._accessToken.next(l.access_token)}})}t()})}catch(r){s(r)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${n.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,s=>{s.error?t(s.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,y.q)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return O(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new T;t.idToken=e;const s=this.decodeJwt(e);return t.id=s.sub,t.name=s.name,t.email=s.email,t.photoUrl=s.picture,t.firstName=s.given_name,t.lastName=s.family_name,t}decodeJwt(e){const s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(s).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}}return n.PROVIDER_ID="GOOGLE",n})(),g=(()=>{var o;class n{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,s){this._ngZone=t,this._injector=s,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new L(1),this.initialized=!1,this._initState=new U,e instanceof Promise?e.then(r=>{this.initialize(r)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(s=>{this.providers.set(s.id,"prototype"in s.provider?this._injector.get(s.provider):s.provider)}),Promise.all(Array.from(this.providers.values()).map(s=>s.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const s=[];let r=!1;this.providers.forEach((l,c)=>{const p=l.getLoginStatus();s.push(p),p.then(k=>{this.setUser(k,c),r=!0}).catch(console.debug)}),Promise.all(s).catch(()=>{r||(this._user=null,this._authState.next(null))})}this.providers.forEach((s,r)=>{(0,E.b)(s.changeUser)&&s.changeUser.subscribe(l=>{this._ngZone.run(()=>{this.setUser(l,r)})})})}).catch(s=>{t(s)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return O(function*(){const s=t.providers.get(e);if(!t.initialized)throw n.ERR_NOT_INITIALIZED;if(!s)throw n.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(s instanceof h))throw n.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield s.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,s)=>{if(this.initialized){const r=this.providers.get(e);r?"function"!=typeof r.refreshToken?s(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):r.refreshToken().then(l=>{this.setUser(l,e),t()}).catch(l=>{s(l)}):s(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(n.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,s)=>{if(this.initialized)if(e!==h.PROVIDER_ID)s(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const r=this.providers.get(e);r instanceof h?r.revokeAccessToken().then(t).catch(s):s(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(n.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((s,r)=>{if(this.initialized){let l=this.providers.get(e);l?l.signIn(t).then(c=>{this.setUser(c,e),s(c)}).catch(c=>{r(c)}):r(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else r(n.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,s)=>{if(this.initialized)if(this._user){let l=this.providers.get(this._user.provider);l?l.signOut(e).then(()=>{t(),this.setUser(null)}).catch(c=>{s(c)}):s(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(n.ERR_NOT_LOGGED_IN);else s(n.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}}return(o=n).ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",o.ERR_NOT_LOGGED_IN="Not logged in",o.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",o.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",o.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",o.\u0275fac=function(e){return new(e||o)(i.LFG("SocialAuthServiceConfig"),i.LFG(i.R0b),i.LFG(i.zs3))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),n})(),A=(()=>{var o;class n{static initialize(e){return{ngModule:n,providers:[g,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}}return(o=n).\u0275fac=function(e){return new(e||o)(i.LFG(o,12))},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({providers:[g],imports:[f.ez]}),n})(),x=(()=>{var o;class n{constructor(e,t){this.type="icon",this.size="medium",this.text="signin_with",this.shape="rectangular",this.theme="outline",this.logo_alignment="left",this.width="",this.locale="",t.initState.pipe((0,y.q)(1)).subscribe(()=>{Promise.resolve(this.width).then(s=>{s>"400"||s<"200"&&""!=s?Promise.reject("Please note .. max-width 400 , min-width 200 (https://developers.google.com/identity/gsi/web/tools/configurator)"):google.accounts.id.renderButton(e.nativeElement,{type:this.type,size:this.size,text:this.text,width:this.width,shape:this.shape,theme:this.theme,logo_alignment:this.logo_alignment,locale:this.locale})})})}}return(o=n).\u0275fac=function(e){return new(e||o)(i.Y36(i.SBq),i.Y36(g))},o.\u0275dir=i.lG2({type:o,selectors:[["asl-google-signin-button"]],inputs:{type:"type",size:"size",text:"text",shape:"shape",theme:"theme",logo_alignment:"logo_alignment",width:"width",locale:"locale"}}),n})(),C=(()=>{var o;class n{}return(o=n).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({}),n})();var u=d(95),m=d(9516),z=d(9427);function M(o,n){1&o&&(i.TgZ(0,"div"),i._uU(1,"Email is required"),i.qZA())}function F(o,n){1&o&&(i.TgZ(0,"div"),i._uU(1,"Email incorrect pattern"),i.qZA())}function j(o,n){if(1&o&&(i.TgZ(0,"div",12),i.YNc(1,M,2,0,"div",13),i.YNc(2,F,2,0,"div",13),i.qZA()),2&o){const a=i.oxw();i.xp6(1),i.Q6J("ngIf",null==a.email.errors?null:a.email.errors.required),i.xp6(1),i.Q6J("ngIf",null==a.email.errors?null:a.email.errors.pattern)}}function V(o,n){1&o&&(i.TgZ(0,"div"),i._uU(1,"Password is required"),i.qZA())}function Z(o,n){1&o&&(i.TgZ(0,"div"),i._uU(1," Password must be at least 3 characters long "),i.qZA())}function q(o,n){if(1&o&&(i.TgZ(0,"div",12),i.YNc(1,V,2,0,"div",13),i.YNc(2,Z,2,0,"div",13),i.qZA()),2&o){const a=i.oxw();i.xp6(1),i.Q6J("ngIf",null==a.password.errors?null:a.password.errors.required),i.xp6(1),i.Q6J("ngIf",null==a.password.errors?null:a.password.errors.minlength)}}const B=[{path:"",component:(()=>{var o;class n{constructor(e,t,s,r){this.authService=e,this.router=t,this.userService=s,this.formBuilder=r,this.loginForm=this.formBuilder.group({email:["",[u.kI.required,u.kI.pattern("[A-Za-z0-9._%-]+@[A-Za-z0-9._%-]+\\.[a-z]{2,5}$")]],password:["",[u.kI.required,u.kI.minLength(3)]],rememberMe:[!1]}),this.user=new T,this.loggedIn=!1}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}ngOnInit(){this.authService.authState.subscribe(e=>{this.user=e,this.loggedIn=null!=e,this.loggedIn&&(localStorage.setItem("email",e.email),this.userService.setUser(this.user),this.router.navigate(["/posts"]).then(t=>t))})}onLoginSubmit(){const e=this.loginForm.value;e&&(localStorage.setItem("email",e.email),this.userService.setUser(this.user),this.router.navigate(["/posts"]).then(t=>t))}}return(o=n).\u0275fac=function(e){return new(e||o)(i.Y36(g),i.Y36(m.F0),i.Y36(z.K),i.Y36(u.qu))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-login"]],decls:21,vars:12,consts:[[1,"container"],[1,"box"],[1,"form",3,"formGroup","ngSubmit"],[1,"form-field"],["for","email"],["type","text","formControlName","email","required","","autocomplete","email","id","email",1,"input"],["class","error",4,"ngIf"],["for","password"],["type","password","formControlName","password","required","","autocomplete","current-password","id","password",1,"input"],["type","checkbox","formControlName","rememberMe"],["type","submit",3,"disabled"],[1,"google-signin-button"],[1,"error"],[4,"ngIf"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"div",1)(2,"form",2),i.NdJ("ngSubmit",function(){return t.onLoginSubmit()}),i.TgZ(3,"div",3)(4,"label",4),i._uU(5,"Email"),i.qZA(),i._UZ(6,"input",5),i.YNc(7,j,3,2,"div",6),i.qZA(),i.TgZ(8,"div",3)(9,"label",7),i._uU(10,"Password"),i.qZA(),i._UZ(11,"input",8),i.YNc(12,q,3,2,"div",6),i.qZA(),i.TgZ(13,"div",3)(14,"label"),i._UZ(15,"input",9),i._uU(16," Remember me "),i.qZA()(),i.TgZ(17,"div",3)(18,"button",10),i._uU(19,"Sign in"),i.qZA()()(),i._UZ(20,"asl-google-signin-button",11),i.qZA()()),2&e&&(i.xp6(2),i.Q6J("formGroup",t.loginForm),i.xp6(4),i.ekj("inputError",t.email.invalid&&(t.email.dirty||t.email.touched))("inputSuccess",t.email.valid),i.xp6(1),i.Q6J("ngIf",t.email.invalid&&(t.email.dirty||t.email.touched)),i.xp6(4),i.ekj("inputError",t.password.invalid&&(t.password.dirty||t.password.touched))("inputSuccess",t.password.valid),i.xp6(1),i.Q6J("ngIf",t.password.invalid&&(t.password.dirty||t.password.touched)),i.xp6(6),i.Q6J("disabled",t.loginForm.invalid))},dependencies:[f.O5,u._Y,u.Fj,u.Wl,u.JJ,u.JL,u.Q7,u.sg,u.u,x],styles:['.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.box[_ngcontent-%COMP%]{width:300px;margin:0 auto;padding:20px;border:1px solid #ccc;border-radius:5px;background-color:#f7f7f7}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-field[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{margin-bottom:5px}.input[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:1px solid #ccc;border-radius:5px;outline:none;box-sizing:border-box}.error[_ngcontent-%COMP%]{color:red;font-size:12px}button[_ngcontent-%COMP%]{width:100%;padding:14px 16px;margin-top:15px;font-size:16px;background-color:#567b95;color:#fff;border:none;border-radius:5px;cursor:pointer;box-sizing:border-box}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}button[_ngcontent-%COMP%]:hover, .google-signin-button[_ngcontent-%COMP%]:hover{background-color:#274665}.google-signin-button[_ngcontent-%COMP%]{display:inline-block;align-items:center;justify-content:center;position:relative;width:100%;padding:14px 16px;background-color:#567b95;color:#fff;border:none;border-radius:5px;font-size:16px;box-sizing:border-box}.google-signin-button[_ngcontent-%COMP%]:after{content:"Sign in with Google";position:absolute;top:50%;left:47%;transform:translate(-40%,-50%)}button[_ngcontent-%COMP%], .google-signin-button[_ngcontent-%COMP%]:active{background-color:#274665}button[_ngcontent-%COMP%], .google-signin-button[_ngcontent-%COMP%]:focus{outline:none}']}),n})()}];let G=(()=>{var o;class n{}return(o=n).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[m.Bz.forChild(B),m.Bz]}),n})();var J=d(9862);let K=(()=>{var o;class n{}return(o=n).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:h.PROVIDER_ID,provider:new h("972926948361-trfec5iqntee7b9id9c728v8ccbml8ie.apps.googleusercontent.com")}],onError:a=>{console.error(a)}}}],imports:[f.ez,G,u.UX,m.Bz,C,A,J.JF]}),n})()}}]);